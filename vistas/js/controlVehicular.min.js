 // console.log("controlVehicular.min.js");
// 
// 
//  

// $('#vehiculo-zoom').zoom();
$(document).ready(function(){

  $('zoomImg').zoom();

});

/*===============================================
          GESTION DE RESPONSABLE 
=================================================*/
$(".tablaResponsable tbody").on("click", ".btnEditarResponsable", function(){

	const idResponsable = $(this).attr("idResponsable");

	let datos = new FormData();
	datos.append("idResponsable", idResponsable);

	$.ajax({
		url:"ajax/responsables.ajax.php",
		method :"POST",
		data:datos, 
		cache: false, 
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){
			$("#loading-max").fadeIn('slow');
		}, 	
		success:function(respuesta){
			console.log("respuesta", respuesta);
			$("#loading-max").fadeOut('slow');
			$("#nombreResponsable").html(respuesta["responsable"]);
			$("#editarResponsableId").val(respuesta["responsable"]);
			$("#responsableId").val(respuesta["idResponsable"]);
		}
	})
})



$('.tablaResponsable tbody').on("click",".btnEliminarResponsable", function(){

	let idResponsable = $(this).attr("idResponsable");
	// console.log("idResponsable", idResponsable);


	Swal.fire({
		title:"¿Estas seguro de borrar el responsable?",
		text:"Puede revertir este proceso cancelando", 
		icon:"warning",
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar responsablenable"

	}).then((result) => {
		
		if(result.isConfirmed){

			window.location = "index.php?ruta=altas-control-vehicular&resp="+idResponsable;
	
		}
	})



})







/*===============================================
          GESTION DE PROPIETARIO 
=================================================*/
$(".tablaPropietario tbody").on("click", ".btnEditarPropietario", function(){

	const idPropietario = $(this).attr("idPropietario");

	let datos = new FormData();
	datos.append("idPropietario", idPropietario);

	$.ajax({
		url:"ajax/propietarios.ajax.php",
		method :"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){
			$("#loading-max").fadeIn('slow');
		}, 	
		success:function(respuesta){
			console.log("respuesta", respuesta);
			$("#loading-max").fadeOut('slow');
			$("#nombrePropietario").html(respuesta["propietario"]);
			$("#editarPropietarioId").val(respuesta["propietario"]);
			$("#propietarioId").val(respuesta["idPropietario"]);
		}
	})
})



$('.tablaPropietario tbody').on("click",".btnEliminarPropietario", function(){

	let idPropietario = $(this).attr("idPropietario");
	// console.log("idPropietario", idPropietario);


	Swal.fire({
		title:"¿Estas seguro de borrar el propietario?",
		text:"Puede revertir este proceso cancelando", 
		icon:"warning",
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar propietario"

	}).then((result) => {
		
		if(result.isConfirmed){

			window.location = "index.php?ruta=altas-control-vehicular&prop="+idPropietario;
	
		}
	})



})






/*===============================================
          GESTION DE TRANSPORTE 
=================================================*/
$(".tablaTransporte tbody").on("click", ".btnEditarTransporte", function(){

	const idTransporte = $(this).attr("idTransporte");

	let datos = new FormData();
	datos.append("idTransporte", idTransporte);

	$.ajax({
		url:"ajax/tipoTransporte.ajax.php",
		method :"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){
			$("#loading-max").fadeIn('slow');
		}, 	
		success:function(respuesta){
			$("#loading-max").fadeOut('slow');
			$("#nombreTransporte").html(respuesta["transporte"]);
			$("#editarTipoTransporteId").val(respuesta["transporte"]);
			$("#transporteId").val(respuesta["idTransporte"]);
		}
	})
})



$('.tablaTransporte tbody').on("click",".btnEliminarTransporte", function(){

	let idTransporte = $(this).attr("idTransporte");
	// console.log("idTransporte", idTransporte);


	Swal.fire({
		title:"¿Estas seguro de borrar el transporte?",
		text:"Puede revertir este proceso cancelando", 
		icon:"warning",
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar transporte"

	}).then((result) => {
		
		if(result.isConfirmed){

			window.location = "index.php?ruta=altas-control-vehicular&q="+idTransporte;
	
		}
	})



})



/*===============================================
          GESTION DE MARCAS 
=================================================*/
$(".tablaMarcas tbody").on("click", ".btnEditarMarca", function(){

	const idMarca = $(this).attr("idMarca"); 
	// console.log("idMarca", idMarca);

	let datos = new FormData();
	datos.append("idMarca", idMarca);

	$.ajax({
		url:"ajax/marcas.ajax.php",
		method :"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){
			$("#loading-max").fadeIn('slow');
		}, 	
		success:function(respuesta){
			$("#loading-max").fadeOut('slow');
			$("#nombreMarca").html(respuesta["marca"]);
			$("#editarMarcaId").val(respuesta["marca"]);
			$("#marcaId").val(respuesta["idMarca"]);
		}
	})


})


$('.tablaMarcas tbody').on("click",".btnEliminarMarca", function(){

	let idMarca = $(this).attr("idMarca");
	// console.log("idMarca", idMarca);


	Swal.fire({
		title:"¿Estas seguro de borrar la marca?",
		html:"Puede revertir este proceso cancelando, la marca no debe de depender de <span class='text-danger text-uppercase'>ninguna submarca</span>", 
		icon:"warning",
		allowOutsideClick: false,
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar marca"

	}).then((result) => {
		
		if(result.isConfirmed){

			window.location = "index.php?ruta=altas-control-vehicular&marca="+idMarca;
	
		}
	})


});



/*===============================================
          GESTION DE SUBMARCAS 
=================================================*/
$(".tablaSubMarcas tbody").on("click", ".btnEditarSubMarca", function(){

	const idSubMarca = $(this).attr("idSubMarca"); 
	// console.log("idSubMarca", idSubMarca);

	let datos = new FormData();
	datos.append("idSubMarca", idSubMarca);

	$.ajax({
		url:"ajax/subMarcas.ajax.php",
		method :"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){
			$("#loading-max").fadeIn('slow');
		}, 	
		success:function(respuesta){
			// console.log("respuesta", respuesta);
			$("#loading-max").fadeOut('slow');
			$("#nombreSubMarca").html(respuesta["submarca"]);
			$("#editarSubMarcaId").val(respuesta["submarca"]);
			$("#subMarcaId").val(respuesta["idSubmarca"]);
			$("#marca2Id").val(respuesta["marca_id"]);
		}
	})


})


$('.tablaSubMarcas tbody').on("click",".btnEliminarSubMarca", function(){

	let idSubMarca = $(this).attr("idSubMarca");
	// console.log("idSubMarca", idSubMarca);


	Swal.fire({
		title:"¿Estas seguro de borrar la submarca?",
		html:"Puede revertir este proceso cancelando, la marca no debe de depender de <span class='text-danger text-uppercase'>ninguna marca</span>", 
		icon:"warning",
		allowOutsideClick: false,
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar submarca"

	}).then((result) => {
		
		if(result.isConfirmed){

			window.location = "index.php?ruta=altas-control-vehicular&submarca="+idSubMarca;
	
		}
	})


});





/*===============================================
          GESTION DE CLASES 
=================================================*/
$(".tablaClases tbody").on("click", ".btnEditarClase", function(){

	const idClase = $(this).attr("idClase"); 
	// console.log("idClase", idClase);

	let datos = new FormData();
	datos.append("idClase", idClase);

	$.ajax({
		url:"ajax/clases.ajax.php",
		method :"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){
			$("#loading-max").fadeIn('slow');
		}, 	
		success:function(respuesta){
			// console.log("respuesta", respuesta);
			$("#loading-max").fadeOut('slow');
			$("#nombreClase").html(respuesta["clase"]);
			$("#editarClaseId").val(respuesta["clase"]);
			$("#claseId").val(respuesta["idClase"]);
			
		}
	})


})


$('.tablaClases tbody').on("click",".btnEliminarClase", function(){

	let idClase = $(this).attr("idClase");
	// console.log("idClase", idClase);


	Swal.fire({
		title:"¿Estas seguro de borrar la clase?",
		html:"Puede revertir este proceso cancelando ", 
		icon:"warning",
		allowOutsideClick: false,
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar clase"

	}).then((result) => {
		
		if(result.isConfirmed){

			window.location = "index.php?ruta=altas-control-vehicular&cls="+idClase;
	
		}
	})


});





/*===============================================
          GESTION DE COMBUSTIBLES 
=================================================*/
$(".tablaCombustibles tbody").on("click", ".btnEditarCombustible", function(){

	const idCombustible = $(this).attr("idCombustible"); 


	let datos = new FormData();
	datos.append("idCombustible", idCombustible);

	$.ajax({
		url:"ajax/combustibles.ajax.php",
		method :"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){
			$("#loading-max").fadeIn('slow');
		}, 	
		success:function(respuesta){
			// console.log("respuesta", respuesta);
			$("#loading-max").fadeOut('slow');
			$("#nombreCombustible").html(respuesta["combustible"]);
			$("#editarCombustibleId").val(respuesta["combustible"]);
			$("#combustibleId").val(respuesta["idCombustible"]);
			
		}
	})


})


$('.tablaCombustibles tbody').on("click",".btnEliminarCombustible", function(){

	let idCombustible = $(this).attr("idCombustible");
	// console.log("idCombustible", idCombustible);


	Swal.fire({
		title:"¿Estas seguro de borrar la combustible ?",
		html:"Puede revertir este proceso cancelando ", 
		icon:"warning",
		allowOutsideClick: false,
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar"

	}).then((result) => {
		
		if(result.isConfirmed){

			window.location = "index.php?ruta=altas-control-vehicular&combs="+idCombustible;
	
		}
	})


});





/*===============================================
          GESTION DE SEGUROS 
=================================================*/
$(".tablaSeguros tbody").on("click", ".btnEditarSeguro", function(){

	const idSeguro = $(this).attr("idSeguro"); 


	let datos = new FormData();
	datos.append("idSeguro", idSeguro);

	$.ajax({
		url:"ajax/seguros.ajax.php",
		method :"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){

			$("#loading-max").fadeIn('slow');
		}, 	
		
		success:function(respuesta){
			// console.log("respuesta", respuesta);
			$("#loading-max").fadeOut('slow');
			$("#nombreSeguro").html(respuesta["seguro"]);
			$("#editarSeguroId").val(respuesta["seguro"]);
			$("#seguroId").val(respuesta["idSeguro"]);
			
		}
	})


})


$('.tablaSeguros tbody').on("click",".btnEliminarSeguro", function(){

	let idSeguro = $(this).attr("idSeguro");
	// console.log("idSeguro", idSeguro);


	Swal.fire({
		title:"¿Estas seguro de borrar el seguro ?",
		html:"Puede revertir este proceso cancelando ", 
		icon:"warning",
		allowOutsideClick: false,
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar"

	}).then((result) => {
		
		if(result.isConfirmed){

			window.location = "index.php?ruta=altas-control-vehicular&seg="+idSeguro;
	
		}
	})


});




/*===============================================
          GESTION DE SEGUROS 
=================================================*/
$(".tablaTramites tbody").on("click", ".btnEditarTramite", function(){

	const idTramite = $(this).attr("idTramite"); 
	// console.log("idTramite", idTramite);


	let datos = new FormData();
	datos.append("idTramite", idTramite);

	$.ajax({
		url:"ajax/tramites.ajax.php",
		method:"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){

			$("#loading-max").fadeIn('slow');
		}, 	
		
		success:function(respuesta){
			console.log("respuesta", respuesta);
			$("#loading-max").fadeOut('slow');
			$("#nombreTramite").html(respuesta["tramite"]);
			$("#editarTramiteId").val(respuesta["tramite"]);
			$("#tramiteId").val(respuesta["idTramite"]);
			
		}
	})


})




/*===============================================
          EDITAR areas
=================================================*/
$(".tablaAreas tbody").on("click", ".btnEditarArea", function(){

	const idAreaV = $(this).attr("idAreaVehiculo"); 

	let datos = new FormData();
	datos.append("idAreaVehiculo", idAreaV);

	$.ajax({
		url:"ajax/areas.ajax.php",
		method:"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){

			$("#loading-max").fadeIn('slow');
		}, 	
		
		success:function(respuesta){
			// console.log("respuesta", respuesta);
			$("#loading-max").fadeOut('slow');

			$("#nombreArea").html(respuesta["area"]);
			$("#editarAreaId").val(respuesta["area"]);
			$("#areaId").val(respuesta["idAreaVehiculo"]);
			
		}
	})


})





$('.tablaTramites tbody').on("click",".btnEliminarTramite", function(){

	let idTramite = $(this).attr("idTramite");
	// console.log("idTramite", idTramite);


	Swal.fire({
		title:"¿Estas seguor de borrar el trámite ?",
		html:"Puede revertir este proceso cancelando ", 
		icon:"warning",
		allowOutsideClick: false,
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar tramite"

	}).then((result) => {
		 
		if(result.isConfirmed){

			window.location = "index.php?ruta=altas-control-vehicular&tram="+idTramite;
	
		}
	})


});




$('.tablaAreas tbody').on("click",".btnEliminarArea", function(){

	let idAreaVehiculo = $(this).attr("idAreaVehiculo");
	// console.log("idTramite", idTramite);


	Swal.fire({
		title:"¿Estas seguro de borrar el área ?",
		html:"Puede revertir este proceso cancelando ", 
		icon:"warning",
		allowOutsideClick: false,
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar área"

	}).then((result) => {
		 
		if(result.isConfirmed){

			window.location = "index.php?ruta=altas-control-vehicular&are="+idAreaVehiculo;
	
		}
	})


});




/*===============================================
          GESTION DE EDICION VEHICULOS 
=================================================*/
$(".tablaVehiculos tbody, #tablaVehiculos2").on("click", ".btnEditarVehiculo", function(){

	const idVehiculo = $(this).attr("idVehiculo");
	// console.log("idVehiculo", idVehiculo);

	let datos = new FormData();
	datos.append("idVehiculo", idVehiculo);

	$.ajax({
		url:"ajax/vehiculos.ajax.php",
		method :"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){
			$("#loading-max").fadeIn('slow');
		}, 	
		success:function(respuesta){
			// console.log("respuesta", respuesta);
			$("#loading-max").fadeOut('slow');
			$("#nombreVehiculo").html(respuesta["modelo"]);
			// $("#editarResponsableId").val(respuesta["responsable"]);
			$("#vehiculoId").val(respuesta["idVehiculo"]);


			$("#editarNumECOId").val(respuesta["eco"]);

			$("#editarTarjetaCirculacionId").val(respuesta["nombreTarjeta"]);
			$("#editarFacturaOrigenId").val(respuesta["facturaOrigen"]);
			$("#editarSerieId").val(respuesta["serie"]);
			$("#editarModeloId").val(respuesta["modelo"]);
			$("#editarAnioId").val(respuesta["anio"]);


			$("#editarlacasId").val(respuesta["placas"]);
			$("#editarTarjetaId").val(respuesta["numTarjeta"]);
			$("#editaroMotorId").val(respuesta["motor"]);
			$("#editarKilometrajeId").val(respuesta["km"]);
			$("#editarHRSId").val(respuesta["hrs"]);


			$("#editarColorId").val(respuesta["color"]);
			$("#editarEstadoFisicoId2").html(respuesta["estadoFisico"]);
			$("#editarEstadoFisicoId2").val(respuesta["estadoFisico"]);
			$("#editarEstadoOperativoId2").html(respuesta["estadoOperativo"]);
			$("#editarEstadoOperativoId2").val(respuesta["estadoOperativo"]);

			$("#editarFechaCompraId").val(respuesta["fechaCompra"]);
			$("#editarNumeroFacturaId").val(respuesta["noFactura"]);
			$("#editarProveedorId").val(respuesta["proveedorCompra"]);
			$("#editarUbicacionId").val(respuesta["ubicacion"]);


			$("#editarEstadoId2").html(respuesta["estatus"]);
			$("#editarEstadoId2").val(respuesta["estatus"]);
			
			$("#editarDescripcionId").val(respuesta["descripcionVehiculo"]);
			$("#editarAccesoriosId").val(respuesta["accesoriosVehiculo"]);
			$("#editarObservacionesId").val(respuesta["observaciones"]);



			
			


			/*===========================================
			      LLAMADO DE PROPIETARIO
			  =========================================*/
			const idPropietario = respuesta["propietario_id"];
			const prop = new FormData();
			prop.append('idPropietario', idPropietario);

			$.ajax({
				url:"ajax/propietarios.ajax.php",
				method :"POST",
				data:prop,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta){

					$("#editarPropietarioId2").html(respuesta["propietario"]);
					$("#editarPropietarioId2").val(respuesta["idPropietario"]);
					// console.log("respuesta", respuesta);

				}

			});

			 /*===========================================
			      LLAMADO DE GPS
			  =========================================*/
			  if(respuesta["gps"] == "1"){

			  	$("#editarGpsId2").html("Si");
			  	$("#editarGpsId2").val(respuesta["gps"]);

			  }else if(respuesta["gps"] == "0"){

			  	$("#editarGpsId2").html("No");
			  	$("#editarGpsId2").val(respuesta["gps"]);

			  }else{

			  	$("#editarGpsId2").html("No");
			  	$("#editarGpsId2").val("0");

			  }



			  /*===========================================
			      LLAMADO DE GPS
			  =========================================*/
			  if(respuesta["duplicadoLlaves"] == "1"){

			  	$("#editarDuplicadoId2").html("Si");
			  	$("#editarDuplicadoId2").val(respuesta["duplicadoLlaves"]);

			  }else if(respuesta["duplicadoLlaves"] == "0"){

			  	$("#editarDuplicadoId2").html("No");
			  	$("#editarDuplicadoId2").val(respuesta["duplicadoLlaves"]);

			  }else{

			  	$("#editarDuplicadoId2").html("No");
			  	$("#editarDuplicadoId2").val("0");

			  }



			 /*===========================================
			      LLAMADO DE CLASES
			  =========================================*/
			const idClase = respuesta["clase_id"];
			const clase = new FormData();
			clase.append('idClase', idClase);

			$.ajax({
				url:"ajax/clases.ajax.php",
				method :"POST",
				data:clase,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta){

					$("#editarClaseVehiculoId2").html(respuesta["clase"]);
					$("#editarClaseVehiculoId2").val(respuesta["idClase"]);
					// console.log("respuesta", respuesta);

				}

			});


			/*===========================================
			      LLAMADO DE MARCA
			  =========================================*/
			const idMarca = respuesta["marca_id"];
			const marca = new FormData();
			marca.append('idMarca', idMarca);

			$.ajax({
				url:"ajax/marcas.ajax.php",
				method :"POST",
				data:marca,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta){

					$("#editarMarcaId2").html(respuesta["marca"]);
					$("#editarMarcaId2").val(respuesta["idMarca"]);
					// console.log("respuesta", respuesta);

				}

			});


			/*===========================================
			      LLAMADO DE SUBMARCA
			  =========================================*/
			const idSubMarca = respuesta["subMarca_id"];
			const submarca = new FormData();
			submarca.append('idSubMarca', idSubMarca);

			$.ajax({
				url:"ajax/subMarcas.ajax.php",
				method :"POST",
				data:submarca,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta){

					$("#editarSubMarcaId2").html(respuesta["submarca"]);
					$("#editarSubMarcaId2").val(respuesta["idSubmarca"]);
					// console.log("respuesta", respuesta);

				}

			});


			/*===========================================
			      LLAMADO DE TRANSPORTE
			  =========================================*/
			const idTransporte = respuesta["transporte_id"];
			const transporte = new FormData();
			transporte.append('idTransporte', idTransporte);

			$.ajax({
				url:"ajax/tipoTransporte.ajax.php",
				method :"POST",
				data:transporte,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta){

					$("#editarTipoTransporteId2").html(respuesta["transporte"]);
					$("#editarTipoTransporteId2").val(respuesta["idTransporte"]);
					// console.log("respuesta", respuesta);

				}

			});


			/*===========================================
			      LLAMADO DE COMBUSTIBLE
			  =========================================*/
			const idCombustible = respuesta["combustible_id"];
			const combustible = new FormData();
			combustible.append('idCombustible', idCombustible);

			$.ajax({
				url:"ajax/combustibles.ajax.php",
				method:"POST",
				data:combustible,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta){

					$("#editarCombustibleId2").html(respuesta["combustible"]);
					$("#editarCombustibleId2").val(respuesta["idCombustible"]);
					// console.log("respuesta", respuesta);

				}

			});


			/*===========================================
			      LLAMADO DE SEGUROS
			 =========================================*/
			const idSeguro = respuesta["seguro_id"];
			const seguro = new FormData();
			seguro.append('idSeguro', idSeguro);

			$.ajax({
				url:"ajax/seguros.ajax.php",
				method:"POST", 
				data:seguro,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta){

					$("#editarSeguroId2").html(respuesta["seguro"]);
					$("#editarSeguroId2").val(respuesta["idSeguro"]);
					// console.log("respuesta", respuesta);

				}

			});


			/*===========================================
			      LLAMADO DE RESPOSNABLE
			 =========================================*/
			const idResponsable = respuesta["responsable_id"];
			const responsable = new FormData();
			responsable.append('idResponsable', idResponsable);

			$.ajax({
				url:"ajax/responsables.ajax.php",
				method:"POST",
				data:responsable,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta2){

					$("#editarResponsableId2").html(respuesta2["responsable"]);
					$("#editarResponsableId2").val(respuesta2["idResponsable"]);
					// console.log("respuesta2", respuesta2);

				}

			});


			/*===========================================
			      LLAMADO DE UNIDADES let unidadNegocio = respuesta["unidad_id"];
			 =========================================*/
			const idAreaVehiculo = respuesta["area_id"];
			const areas = new FormData();
			areas.append('idAreaVehiculo', idAreaVehiculo);

			$.ajax({
				url:"ajax/areas.ajax.php",
				method:"POST",
				data:areas,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta2){
					console.log("respuesta Ve2", respuesta2);


					if(!respuesta2){

						$("#editarUnidaNegocioVehiculoId2").html('-- SELECCIONAR AREA --');
						$("#editarUnidaNegocioVehiculoId2").val("");

					}else{

						$("#editarUnidaNegocioVehiculoId2").html(respuesta2["area"]);
						$("#editarUnidaNegocioVehiculoId2").val(respuesta2["idAreaVehiculo"]);

					}

				}

			});




			/*===========================================
			      LLAMADO DE CORRESPOSNABLES
			 =========================================*/
			const idUsuario = respuesta["usuario_asignado_id"];
			const usuarios = new FormData();
			usuarios.append('idUsuario', idUsuario);

			$.ajax({
				url:"ajax/usuarios.ajax.php",
				method:"POST",
				data:usuarios,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				beforeSend: function(){
					
					$("#loading-max").fadeIn('slow');

				},
				success:function(respuesta2){

				   console.log("respuesta2", respuesta2);
				   
				   const select = $("#editarReCorresponsableId");
				   // select.empty();
					if(respuesta2 == false){
						$("#editarCorresponsableId2").html('-- SELECCIONAR CORRESPONSABLE --');
						$("#editarCorresponsableId2").val("");
						// select.append('<option value="" selected>-- SELECCIONAR CORRESPONSABLE¿ --</option>');
					}else{
						$("#editarCorresponsableId2").html(respuesta2["responsable"]);
						$("#editarCorresponsableId2").val(respuesta2["idResponsable"]);
						// Agregamos las nuevas opciones al select dinámicamente
						 // select.append(`<option value="${respuesta2.id}" selected>${respuesta2.nombre}</option>`);
						
					}
					    // Refrescar el selectpicker
			            select.selectpicker('refresh');
				}

			});


			$("#loading-max").fadeOut('slow');

		}
	})
})




$('.tablaVehiculos tbody, #tablaVehiculos2').on("click",".btnEliminarVehiculo", function(){

	let idVehiculo = $(this).attr("idVehiculo");
	console.log("idVehiculo", idVehiculo);
	


	Swal.fire({
		title:"¿Estas seguro de borrar el vehículo ?",
		html:"<span class='text-danger text-bold'> ¡ Este proceso se elimina todo el registro del vehículo y su documentación !</span> <br>Puede revertir este proceso cancelando	", 
		icon:"warning",
		allowOutsideClick: false,
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		cancelButtonText: "¡ CANCELAR !",
		confirmButtonText: "SI, ¡ BORRAR VEHICULO !"

	}).then((result) => {
		
		if(result.isConfirmed){

			window.location = "index.php?ruta=nuevo-vehiculo&vd="+idVehiculo;
	
		}
	})


});






 /*--=====================================
 =            DATE TIMEPICKEr          =
 ======================================*/
 $('#nuevoAnioId').datetimepicker({
     language:"es"
    /* locale:"mx",
     format: 'yyyy-mm-dd hh:mm:ss'*/
  });






/*===============================================
          GESTION DE TENENCIAS 
=================================================*/
$(".tablaTenencia tbody").on("click", ".btnEditarTenencia", function(){

	const idTenencia = $(this).attr("idTenencia"); 
	// console.log("idTenencia", idTenencia);


	let datos = new FormData();
	datos.append("idTenencia", idTenencia);

	$.ajax({
		url:"ajax/tenencias.ajax.php",
		method:"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){

			$("#loading-max").fadeIn('slow');
		}, 	
		
		success:function(respuesta){

			// console.log("respuesta", respuesta);


			let idVehiculo = respuesta["vehiculo_id"];
			let vehiculo = new FormData();
			vehiculo.append('idVehiculo', idVehiculo);

			$.ajax({
				url:"ajax/vehiculos.ajax.php",
				method:"POST",
				data:vehiculo,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta){

					$("#nuevoVehiculoId2").val(respuesta["idVehiculo"]);
					$("#nuevoVehiculoId2").html(respuesta["folio"]+" - "+respuesta["placas"]+" - "+respuesta["modelo"]);

					// console.log("respuesta", respuesta);

				}

			})


			$("#editarAnioId").val(respuesta["anio"]);
			$("#editarPagoId").val(respuesta["pago"]);
			$("#editarFechaPagoIdTenencia").val(respuesta["fechaPago"]);

			$("#idTenenciaId").val(respuesta["idTenencia"]);


			$("#loading-max").fadeOut('slow');
			
			
			
			
		}
	})


})


$('.tablaTenencia tbody').on("click",".btnEliminarTenencia", function(){

	let idTenencia = $(this).attr("idTenencia");
	console.log("idTenencia", idTenencia);
// 

	Swal.fire({
		title:"¿Estas seguro de borrar la tenencia ?",
		html:"Puede revertir este proceso cancelando ", 
		icon:"warning",
		allowOutsideClick: false,
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar tenencia"

	}).then((result) => {
		
		if(result.isConfirmed){

			window.location = "index.php?ruta=control-tenencias&tenen="+idTenencia;
	
		}
	})


});





/*===============================================
          GESTION DE VERIFICACIONES 
=================================================*/
$(".tablaVerificaciones tbody").on("click", ".btnEditarVerificacion", function(){

	const idVerificacion = $(this).attr("idVerificacion"); 
	// console.log("idVerificacion", idVerificacion);


	let datos = new FormData();
	datos.append("idVerificacion", idVerificacion);

	$.ajax({
		url:"ajax/verificaciones.ajax.php",
		method:"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){

			$("#loading-max").fadeIn('slow');
		}, 	
		
		success:function(respuesta){


			// console.log("respuesta", respuesta);


			if(respuesta["tipoVerificacion"] == "1"){

				$("#tituloVerificacion").html("Primer Semestre");

			}else if(respuesta["tipoVerificacion"] == "2"){

				$("#tituloVerificacion").html("Segundo Semestre");
			}


			if(respuesta["estatus"] == "0"){

				$("#tituloEstado").html("Pendiente");

			}else if(respuesta["estatus"] == "1"){

				$("#tituloEstado").html("Verificado");
			}





			$("#editaridVerificacionId").val(respuesta["idVerif"]);

			$("#editarAnioVerificacionId").val(respuesta["anio"]);

			if(respuesta["tipoVerificacion"] == "1"){

				$("#editarIdTipoVeri").html("Primer Semestre");
				$("#editarIdTipoVeri").val("1");

			}else if(respuesta["tipoVerificacion"] == "2"){

				$("#editarIdTipoVeri").html("Segundo Semestre");
				$("#editarIdTipoVeri").val("2");
			}



			$("#editarVericacionId").val(respuesta["verificacion"]);
			$("#editarFechaPagoId").val(respuesta["fecha"]);

			$("#editarObservacionId").val(respuesta["observaciones"]);



			if(respuesta["estatus"] == "0"){

				$("#ideditarEstatusVerificdoId").val("0");
				$("#ideditarEstatusVerificdoId").html("Pendiente");

			}else if(respuesta["estatus"] == "1"){

				$("#ideditarEstatusVerificdoId").val("1");
				$("#ideditarEstatusVerificdoId").html("Verificado");

			}else if(respuesta["estatus"] == "2"){

				$("#ideditarEstatusVerificdoId").val("2");
				$("#ideditarEstatusVerificdoId").html("N/A");

			}else if(respuesta["estatus"] == "3"){

				$("#ideditarEstatusVerificdoId").val("3");
				$("#ideditarEstatusVerificdoId").html("Exento / 00");
			}




			// $("#editarEstatusVerificdoId").val(respuesta["estatus"]);
			// $("#editaridVerificacionId").val(respuesta["idVerif"]);


			$("#identidadVerificacionId").val(respuesta["idVerificacion"]);

			let idVehiculo = respuesta["vehiculo_id"];
			let vehiculos = new FormData();
			vehiculos.append('idVehiculo', idVehiculo);

			$.ajax({
				url:"ajax/vehiculos.ajax.php",
				method:"POST",
				data:vehiculos,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta){

					$("#editarVehiculoId2").html(respuesta["folio"]+" - "+respuesta["placas"]+" - "+respuesta["modelo"]);
					$("#editarVehiculoId2").val(respuesta["idVehiculo"]);

				}	
			})

			$("#loading-max").fadeOut('slow');
		}

	})

})



$('.tablaVerificaciones tbody').on("click",".btnEliminarVerificacion", function(){

	let idVerificacion = $(this).attr("idVerificacion");
	// console.log("idVerificacion", idVerificacion); 

	Swal.fire({
		title:"¿Estas seguro de borrar la verificación?",
		html:"Puede revertir este proceso cancelando ", 
		icon:"warning",
		allowOutsideClick: false,
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar verificación"

	}).then((result) => {
		
		if(result.isConfirmed){

			window.location = "index.php?ruta=control-verificaciones&verif="+idVerificacion;
	
		}
	})


});



$(".nuevoVehiculoVerificacion").change(function() {

	let idVehiculo = $(this).val();
	// console.log("idVehiculo", idVehiculo);


	if(idVehiculo == ""){

		Swal.fire({
	 		title:"¡ Advertencia !",
	 		text:"Debes de seleccionar un folio", 
	 		icon:"warning",
	 		allowOutsideClick: false,
	 		cancelButtonColor:"#d33",
	 		confirmButtonText: "Cerrar"

 		})

	}else{

		$("#nuevoIDVerificacionId").val("");
		$("#nuevoTipoVerificacionId").val("");
		$("#nuevaVericacionId").val("");
		$("#nuevaFechaPagoId").val("");
		$("#nuevaObservacionId").val("");
		$("#nuevoEstatusVerificdo").val("");

		let datos = new FormData();
		datos.append("idVehiculo", idVehiculo);

		$.ajax({
			url:"ajax/vehiculos.ajax.php",
			method:"POST",
			data:datos,
			cache: false,
			contentType: false,
			processData: false,
			dataType: "json",
			beforeSend:function(o){

				$("#loading-max").fadeIn('slow');
			}, 	
			
			success:function(respuesta){
				// console.log("respuesta", respuesta);
				let placas = respuesta["placas"];
				// console.log("placas", placas);

				let ultimoNum = lastNumber(placas);
				// console.log("ultimoNum", ultimoNum);

				$("#nuevoIDVerificacionId").val(ultimoNum);

				

				$("#loading-max").fadeOut('slow');
			}
		})

	}
	
});





$(".editarVehiculoVerificacion").change(function() {

	let idVehiculo = $(this).val();
	// console.log("idVehiculo", idVehiculo);


	if(idVehiculo == ""){

		Swal.fire({
	 		title:"¡ Advertencia !",
	 		text:"Debes de seleccionar un folio", 
	 		icon:"warning",
	 		allowOutsideClick: false,
	 		cancelButtonColor:"#d33",
	 		confirmButtonText: "Cerrar"

 		})

	}else{

		$("#nuevoIDVerificacionId").val("");
		$("#nuevoTipoVerificacionId").val("");
		$("#nuevaVericacionId").val("");
		$("#nuevaFechaPagoId").val("");
		$("#nuevaObservacionId").val("");
		$("#nuevoEstatusVerificdo").val("");

		let datos = new FormData();
		datos.append("idVehiculo", idVehiculo);

		$.ajax({
			url:"ajax/vehiculos.ajax.php",
			method:"POST",
			data:datos,
			cache: false,
			contentType: false,
			processData: false,
			dataType: "json",
			beforeSend:function(o){

				$("#loading-max").fadeIn('slow');
			}, 	
			
			success:function(respuesta){
				// console.log("respuesta", respuesta);
				let placas = respuesta["placas"];
				// console.log("placas", placas);

				let ultimoNum = lastNumber(placas);
				// console.log("ultimoNum", ultimoNum);

				$("#editaridVerificacionId").val(ultimoNum);

				

				$("#loading-max").fadeOut('slow');
			}
		})

	}
	
});




function lastNumber(cadena){

	let numero = cadena.match(/\d+/g);

	if(numero && numero.length > 0){

		let ultimo = numero.pop();

		return parseInt(ultimo.charAt(ultimo.length -1));
	}

	return null

	// return cadena.match(/\d+/g).map(Number).pop();
}


function seleccionSemestre(){

 let idVerificacion = $("#nuevoIDVerificacionId").val();
 let tipoVerificacion = $("#nuevoTipoVerificacionId").val();
 

	 if(idVerificacion == "" || tipoVerificacion == ""){

	 	Swal.fire({
	 		title:"¡ Advertencia !",
	 		text:"El ID y tipo de verificación no debe estar vacio", 
	 		icon:"warning",
	 		allowOutsideClick: false,
	 		cancelButtonColor:"#d33",
	 		confirmButtonText: "Cerrar"

 		})

 		$("#nuevoTipoVerificacionId").val("");



 	}else if(idVerificacion == "1" && tipoVerificacion == "1"){

 		$("#nuevaVericacionId").val("ABR MAY");

 	}else if(idVerificacion == "1" && tipoVerificacion == "2"){

 		$("#nuevaVericacionId").val("OCT NOV");

 	}else if(idVerificacion == "2" && tipoVerificacion == "1"){

 		$("#nuevaVericacionId").val("ABR MAY");

 	}else if(idVerificacion == "2" && tipoVerificacion == "2"){

 		$("#nuevaVericacionId").val("OCT NOV");

//--------------------------------------------------------------
//

 	}else if(idVerificacion == "3" && tipoVerificacion == "1"){

 		$("#nuevaVericacionId").val("MAR ABR");

 	}else if(idVerificacion == "3" && tipoVerificacion == "2"){

 		$("#nuevaVericacionId").val("SEP OCT");

 	}else if(idVerificacion == "4" && tipoVerificacion == "1"){

 		$("#nuevaVericacionId").val("MAR ABR");

 	}else if(idVerificacion == "4" && tipoVerificacion == "2"){

 		$("#nuevaVericacionId").val("SEP OCT");

//---------------------------------------------------------------
 	}else if(idVerificacion == "5" && tipoVerificacion == "1"){

 		$("#nuevaVericacionId").val("ENE FEB");

 	}else if(idVerificacion == "5" && tipoVerificacion == "2"){

 		$("#nuevaVericacionId").val("JUL AGO");

 	}else if(idVerificacion == "6" && tipoVerificacion == "1"){

 		$("#nuevaVericacionId").val("ENE FEB");

 	}else if(idVerificacion == "6" && tipoVerificacion == "2"){

 		$("#nuevaVericacionId").val("JUL AGO");

// -----------------------------------------------------------------

 	}else if(idVerificacion == "7" && tipoVerificacion == "1"){

 		$("#nuevaVericacionId").val("FEB MAR");

 	}else if(idVerificacion == "7" && tipoVerificacion == "2"){

 		$("#nuevaVericacionId").val("AGO SEP");

 	}else if(idVerificacion == "8" && tipoVerificacion == "1"){

 		$("#nuevaVericacionId").val("FEB MAR");
 	
 	}else if(idVerificacion == "8" && tipoVerificacion == "2"){

 		$("#nuevaVericacionId").val("AGO SEP");

// -------------------------------------------------------------------

 	}else if(idVerificacion == "9" && tipoVerificacion == "1"){

 		$("#nuevaVericacionId").val("MAY JUN");

 	}else if(idVerificacion == "9" && tipoVerificacion == "2"){

 		$("#nuevaVericacionId").val("NOV DIC");

 	}else if(idVerificacion == "0" && tipoVerificacion == "1"){

 		$("#nuevaVericacionId").val("MAY JUN");

	}else if(idVerificacion == "0" && tipoVerificacion == "2"){

	 	$("#nuevaVericacionId").val("NOV DIC");

	}


}


$("#nuevoTipoVerificacionId").change(function() {

	seleccionSemestre();

});



$("#nuevaFechaPagoId").change(function(){

	let fechaStr = $(this).val();
	let valorEstatus = $("#nuevoEstatusVerificdoId").val();



	// console.log("valorEstatus", valorEstatus);
	// console.log("fechaStr;",fechaStr);

	let fechaCaptura = new Date(fechaStr+" 00:00:00");
	// console.log("fechaCaptura;", fechaCaptura);

	let hoy = new Date();
	// console.log("hoy:", hoy);

	if(!valorEstatus){

		Swal.fire({
			title:"¡ Advertencia !",
			text:"El estatus no debe estar vacio", 
			icon:"warning",
			allowOutsideClick: false,
			cancelButtonColor:"#d33",
			confirmButtonText: "Cerrar"

		})

		$("#nuevaFechaPagoId").val("");

	}else{

		let estatus = $("#nuevoEstatusVerificdoId").val();

		if(estatus == "0"){

			console.log("-");

		}else if(estatus == "1"){

				if(estatus == "1" && fechaCaptura <= hoy ){

					console.log("--");

				}else if(estatus == "1" && fechaCaptura > hoy){

					Swal.fire({
						title:"¡ Advertencia !",
						text:"La fecha no debe ser mayor a la actual", 
						icon:"warning",
						allowOutsideClick: false,
						cancelButtonColor:"#d33",
						confirmButtonText: "Cerrar"

					})

				$("#nuevaFechaPagoId").val("");
			}
		}
	}

})


// CONDICIONANTE PARA EL ESTATUS DEL VEHICULO EN NUEVA VERIFICACIÓN

$("#nuevoEstatusVerificdoId").change(function(){

	let estatus = $(this).val();
	// console.log("estatus", estatus);
	let fechaPagoStr = $("#nuevaFechaPagoId").val();
	let fechaPago = new Date(fechaPagoStr+" 00:00:00");


	if(fechaPagoStr){

		// console.log("fechaPago", fechaPago);

		let hoy = new Date();
		// console.log("hoy", hoy);

		if(estatus == "1" && fechaPago == ""){

			Swal.fire({
				title:"¡ Advertencia !",
				text:"Selecciona tu fecha a partir de hoy o a días posteriores", 
				icon:"warning",
				allowOutsideClick: false,
				cancelButtonColor:"#d33",
				confirmButtonText: "Cerrar"

			})

			$("#nuevaFechaPagoId").val("");

		}else if(estatus == "1" && fechaPago > hoy ){

			Swal.fire({
				title:"¡ Advertencia !",
				text:"La fecha no debe ser mayor a la actual", 
				icon:"warning",
				allowOutsideClick: false,
				cancelButtonColor:"#d33",
				confirmButtonText: "Cerrar"

			})

			$("#nuevaFechaPagoId").val("");

		}


	}




})












/*===============================================
          GESTION DE SEGURO VEHICULOS 
=================================================*/
$(".tablaSegVeh tbody").on("click", ".btnEditarSeguroVehiculo", function(){

	const idSegVeh = $(this).attr("idSegVeh"); 
	// console.log("idVerificacion", idVerificacion);


	let datos = new FormData();
	datos.append("idSegVeh", idSegVeh);

	$.ajax({
		url:"ajax/seguros-vehiculos.ajax.php",
		method:"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){

			$("#loading-max").fadeIn('slow');
		}, 	
		
		success:function(respuesta){

			console.log("respuesta", respuesta);
			
			$("#idSegVehId").val(respuesta["idSegVeh"]);
			$("#editarPOlizaId").val(respuesta["poliza"]);
			$("#editarIncisoId").val(respuesta["inciso"]);
			$("#editarVigenciaId").val(respuesta["vigencia"]);
			$("#editarObservacionesSeguroId").val(respuesta["observaciones"]);


			let idVehiculo = respuesta["vehiculo_id"];
			let vehiculos = new FormData();
			vehiculos.append('idVehiculo', idVehiculo);

			$.ajax({
				url:"ajax/vehiculos.ajax.php",
				method:"POST",
				data:vehiculos,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta){

					$("#editSegVehiculoId2").html(respuesta["folio"]+" - "+respuesta["placas"]+" - "+respuesta["modelo"]);
					$("#editSegVehiculoId2").val(respuesta["idVehiculo"]);

				}	
			})



			let idSeguro = respuesta["seguro_id"];
			let seguros = new FormData();
			seguros.append('idSeguro', idSeguro);

			$.ajax({
				url:"ajax/seguros.ajax.php",
				method:"POST",
				data:seguros,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta){

					$("#editSeguroVehId2").html(respuesta["seguro"]);
					$("#editSeguroVehId2").val(respuesta["idSeguro"]);

				}	
			})

			$("#loading-max").fadeOut('slow');
		}

	})

})



$('.tablaSegVeh tbody').on("click",".btnEliminarSeguroVehiculo", function(){

	let idSegVeh = $(this).attr("idSegVeh");
	console.log("idSegVeh", idSegVeh); 

	Swal.fire({
		title:"¿Estas seguro de borrar el seguro?",
		html:"Puede revertir este proceso cancelando ", 
		icon:"warning",
		allowOutsideClick: false,
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar seguro"

	}).then((result) => {
		
		if(result.isConfirmed){

			window.location = "index.php?ruta=control-seguros&segVeh="+idSegVeh;
	
		}
	})


});






/*===============================================
          GESTION DE SERVICIOS VEHICULARES 
=================================================*/
$(".tablaServiciosVehiculares tbody").on("click", ".btnEditarServicioVehiculo", function(){

	const idServicioVehiculo = $(this).attr("idServicioVehiculo"); 
	// console.log("idVerificacion", idVerificacion);


	let datos = new FormData();
	datos.append("idServicioVehiculo", idServicioVehiculo);

	$.ajax({
		url:"ajax/servicios-vehiculos.ajax.php",
		method:"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){

			$("#loading-max").fadeIn('slow');
		}, 	
		
		success:function(respuesta){

			// console.log("respuesta", respuesta);

			$("#editarServicioVehiculoId").val(respuesta["servicio"]);
			$("#editarTallerServicioId").val(respuesta["taller"]);
			$("#editarFechaServicioId").val(respuesta["fecha"]);
			$("#editarObservacionesServicioId").val(respuesta["observaciones"]);
			$("#idServicioVehiculoId").val(respuesta["idVehiculoServicio"]);


			let idVehiculo = respuesta["vehiculo_id"];
			let vehiculos = new FormData();
			vehiculos.append('idVehiculo', idVehiculo);

			$.ajax({
				url:"ajax/vehiculos.ajax.php",
				method:"POST",
				data:vehiculos,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta){

					$("#editarVehiculoServicioId").html(respuesta["folio"]+" - "+respuesta["placas"]+" - "+respuesta["modelo"]);
					$("#editarVehiculoServicioId").val(respuesta["idVehiculo"]);

				}	
			})




			$("#loading-max").fadeOut('slow');
		}

	})

})



$('.tablaServiciosVehiculares tbody').on("click",".btnEliminarServicioVehiculo", function(){

	let idServicioVehiculo = $(this).attr("idServicioVehiculo");
	// console.log("idServicioVehiculo", idServicioVehiculo);
	

	Swal.fire({
		title:"¿Estas seguro de borrar el servicio?",
		html:"Puede revertir este proceso cancelando ", 
		icon:"warning",
		allowOutsideClick: false,
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar servicio"

	}).then((result) => {
		
		if(result.isConfirmed){

			window.location = "index.php?ruta=control-servicios&serVeh="+idServicioVehiculo;
	
		}
	})


});







/*===============================================
          GESTION DE TRAMITES VEHICULARES 
=================================================*/
$(".tablaTramitesVehiculos tbody").on("click", ".btnEditarTramiteVeh", function(){

	const idTramiteVehiculo = $(this).attr("idTramiteVeh"); 
	// console.log("idVerificacion", idVerificacion);


	let datos = new FormData();
	datos.append("idTramiteVehiculo", idTramiteVehiculo);

	$.ajax({
		url:"ajax/tramites-vehiculos.ajax.php",
		method:"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){

			$("#loading-max").fadeIn('slow');
		}, 	
		
		success:function(respuesta){

			console.log("respuesta", respuesta);

			$("#editarFechaTramiteId").val(respuesta["fecha"]);
			$("#editarObservacionesTramiteId").val(respuesta["observaciones"]);
			$("#TramiteVehiculoId").val(respuesta["idTramiteVehiculo"]);


			if(respuesta["estado"] == "0"){

				$("#estatusTramiteId").html("Pendiente");
				$("#estatusTramiteId").val("0");

			}else if(respuesta["estado"] == "1"){

				$("#estatusTramiteId").html("Realizado");
				$("#estatusTramiteId").val("1");

			}
			// $("#editarEstatusTramiteId").val(respuesta["estado"]);

			let idVehiculo = respuesta["vehiculo_id"];
			let vehiculos = new FormData();
			vehiculos.append('idVehiculo', idVehiculo);

			$.ajax({
				url:"ajax/vehiculos.ajax.php",
				method:"POST",
				data:vehiculos,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta){

					$("#editarVehiculoTramiteId2").html(respuesta["folio"]+" - "+respuesta["placas"]+" - "+respuesta["modelo"]);
					$("#editarVehiculoTramiteId2").val(respuesta["idVehiculo"]);

				}	
			})



			let idTramite = respuesta["tramite_id"];
			let tramites = new FormData();
			tramites.append('idTramite', idTramite);

			$.ajax({
				url:"ajax/tramites.ajax.php",
				method:"POST",
				data:tramites,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success:function(respuesta){

					$("#editarTramiteVehId2").html(respuesta["tramite"]);
					$("#editarTramiteVehId2").val(respuesta["idTramite"]);



				}
			})


			$("#loading-max").fadeOut('slow');
		}

	})

})



$('.tablaTramitesVehiculos tbody').on("click",".btnEliminarTramiteVeh", function(){

	let idTramiteVehiculo = $(this).attr("idTramiteVeh");
	// console.log("idServicioVehiculo", idServicioVehiculo);
	

	Swal.fire({
		title:"¿Estas seguro de borrar el trámite?",
		html:"Puede revertir este proceso cancelando ", 
		icon:"warning",
		allowOutsideClick: false,
		showCancelButton:true,
		confirmButtonColor:"#3085d6",
		cancelButtonColor:"#d33",
		confirmButtonText: "Si, borrar trámite"

	}).then((result) => {
		
		if(result.isConfirmed){

			window.location = "index.php?ruta=control-tramites&tratVeh="+idTramiteVehiculo;
	
		}
	})


});



$("#nuevaFechaTramiteId").change(function(){

	let fechaStr = $(this).val();
	let valorEstatus = $("#nuevoEstatusTramiteId").val();



	// console.log("valorEstatus", valorEstatus);
	// console.log("fechaStr;",fechaStr);

	let fechaCaptura = new Date(fechaStr+" 00:00:00");
	// console.log("fechaCaptura;", fechaCaptura);

	let hoy = new Date();
	// console.log("hoy:", hoy);

	if(!valorEstatus){

		Swal.fire({
			title:"¡ Advertencia !",
			text:"El estatus no debe estar vacio", 
			icon:"warning",
			allowOutsideClick: false,
			cancelButtonColor:"#d33",
			confirmButtonText: "Cerrar"

		})

		$("#nuevaFechaTramiteId").val("");

	}else{

		let estatus = $("#nuevoEstatusTramiteId").val();

		if(estatus == "0"){

			console.log("-");

		}else if(estatus == "1"){

				if(estatus == "1" && fechaCaptura <= hoy ){

					console.log("--");

				}else if(estatus == "1" && fechaCaptura > hoy){

					Swal.fire({
						title:"¡ Advertencia !",
						text:"La fecha no debe ser mayor a la actual", 
						icon:"warning",
						allowOutsideClick: false,
						cancelButtonColor:"#d33",
						confirmButtonText: "Cerrar"

					})

					$("#nuevaFechaTramiteId").val("");
			}
		}
	}

})

$("#nuevoEstatusTramiteId").change(function() {
	
	$("#nuevaFechaTramiteId").val("");

});


	/*Swal.fire({
			title:"¡ Advertencia !",
			text:"La fecha y estatus no debe estar vacio", 
			icon:"warning",
			allowOutsideClick: false,
			cancelButtonColor:"#d33",
			confirmButtonText: "Cerrar"*/


$('input[name="nuevaVigencia"], input[name="editarVigencia"]').daterangepicker({

	"locale": {

        "format": "DD-MM-YYYY",
        "separator": " - ",
        "applyLabel": "Aplicar",
        "cancelLabel": "Cancelar",
        "fromLabel": "From",
        "toLabel": "To",
        "customRangeLabel": "Custom",
        "daysOfWeek": [
            "Do",
            "Lu",
            "Ma",
            "Mi",
            "Ju",
            "Vi",
            "Sa"
        ],

        "monthNames": [
            "Enero",
            "Febrero",
            "Marzo",
            "Abril",
            "Mayo",
            "Junio",
            "Julio",
            "Agosto",
            "Septiembre",
            "Octubre",
            "Noviembre",
            "Deciembre"
        ], 

        "firstDay": 1
    }

});


$(".nuevoAnio").datetimepicker({

	"allowInputToggle": true,
            "showClose": true,
            "showClear": true,
            "showTodayButton": true,
            "format": "YYYY",

});

$(function(){
        $('#id_4').datetimepicker({
            "allowInputToggle": true,
            "showClose": true,
            "showClear": true,
            "showTodayButton": true,
            "format": "YYYY",
        });
   });


  // $('input[name="nuevaVigencia"]').on('apply.daterangepicker', function(ev, picker) {

  //     $(this).val(picker.startDate.format('DD-MM-YYYY') + ' - ' + picker.endDate.format('DD-MM-YYYY'));
  // });

  // $('input[name="nuevaVigencia"]').on('cancel.daterangepicker', function(ev, picker) {

  //     $(this).val('');

  // });
  // 
  // 
  


  /*======================================
    IMPRIMIR EN PDF REPORTE DE VEHICULO
  ======================================*/
$(".tablaVehiculos tbody").on("click", ".btnReporteVehiculo", function(){

	const idVehiculo = $(this).attr("idVehiculo");

	window.open("extensiones/phpword/formatos/reporteVehiculo.php?idVehiculo="+idVehiculo, "_blank");
	
})


  /*======================================
    IMPRIMIR EN PDF REPORTE DE VEHICULO
  ======================================*/
$(".tablaVehiculos tbody").on("click", ".btnReporteVehiculoXls", function(){

	const idVehiculo = $(this).attr("idVehiculo");

	window.open("extensiones/phpexcel/formatos/reportes-invoke-vehiculo.php?idVehiculo="+idVehiculo, "_blank");

	
})


  /*======================================
    IMPRIMIR EN PDF REPORTE DE VEHICULO
  ======================================*/
$(".btnGralReporteVehiculoXls").click(function() { 

	window.open("extensiones/phpexcel/formatos/reportes-invoke-vehiculo-gral.php", "_blank");

});

$(".btnGralReporteVehiculoXlsUnidad").click(function() { 

	window.open("extensiones/phpexcel/formatos/reportes-invoke-vehiculo-unidad.php", "_blank");

});

 


  /*=========================================================
    VERIFICAR SI YA EXISTE MODELO DE VEHICULO
  ============================================================*/


 $("#nuevaSerieId").change(function(){

	$(".alert").remove();

	let vehiculo = $(this).val();
	let datos = new FormData();

	datos.append("validarVehiculo", vehiculo);

	$.ajax({
		url:"ajax/vehiculos.ajax.php",
		method:"POST", 
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		success: function(respuesta){
			// console.log("respuesta", respuesta);

			if(respuesta){
				$("#nuevaSerieId").parent().after('<div class="alert alert-danger">¡ La serie o dato ya existe en la base de datos !</div>');
				$("#nuevaSerieId").val('');
			}
		}

	})

})



 $("#editarSerieId").change(function(){

	$(".alert").remove();

	let vehiculo = $(this).val();
	let datos = new FormData();

	datos.append("validarVehiculo", vehiculo);

	$.ajax({
		url:"ajax/vehiculos.ajax.php",
		method:"POST", 
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		success: function(respuesta){
			// console.log("respuesta", respuesta);

			if(respuesta){
				$("#editarSerieId").parent().after('<div class="alert alert-danger">¡ La serie o dato ya existe en la base de datos !</div>');
				$("#editarSerieId").val('');
			}
		}

	})

})

	




$(".tablaSolicitudesVehiculos tbody").on("click", ".btnTerminarSolicitud", function(){

	const idSolicitud = $(this).attr("idSolicitud");
	// console.log("idSolicitud", idSolicitud);

	let datos = new FormData();
	datos.append("idSolicitudVehiculo", idSolicitud);

	$.ajax({
		url:"ajax/vehiculos-solicitudes.ajax.php",
		method:"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){

			$("#loading-max").fadeIn('slow');
		}, 	
		
		success:function(respuesta){

			// console.log("respuesta", respuesta);

			$("#idSolicitudVehiculo").val(respuesta["idSolicitud"]);
			$("#tituloSolicitante").html(", <strong>Petición solicitada:</strong> "+respuesta["titulo"]);

			const idUsuario = respuesta["solicitante_id"];
			
			let datos = new FormData();
			datos.append("idUsuario", idUsuario);

			$.ajax({
				url:"ajax/usuarios.ajax.php",
				method:"POST",
				data:datos,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				beforeSend:function(o){

					$("#loading-max").fadeIn('slow');
				}, 	
				
				success:function(respuesta){

					$("#nombreSolicitante").html(respuesta["nombre"].toUpperCase());


					// console.log("respuesta", respuesta);


				}

			})


			$("#loading-max").fadeOut('slow');

		}


	})

	
})




$(".tablaSolicitudesVehiculos tbody").on("click", ".btnIniciarSolicitud", function(){

	const solicitudInicial = $(this).attr("idSolicitud");

	let datos = new FormData();
	datos.append("solicitudInicial", solicitudInicial);

	$.ajax({
		url:"ajax/vehiculos-solicitudes.ajax.php",
		method:"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){

			$("#loading-max").fadeIn('slow');
		}, 	
		success:function(respuesta){

			console.log("respuesta", respuesta);

			if(respuesta == "ok"){

				Swal.fire({
					position: "top-end",
					icon: "success",
					title: "Se ha iniciado",
					allowOutsideClick: false,
					showConfirmButton: true
					// timer: 1500
				}).then((result)=> {

					if(result.value){

						window.location = "solicitudes-vehiculo";
					}

				}); 

			}

			$("#loading-max").fadeOut('slow');

		}

	});

});



$(".tablaSolicitudesVehiculos tbody").on("click", ".btnProcesarSolicitud", function(){

	const solicitudProceso = $(this).attr("idSolicitud");
	// console.log("solicitudProceso", solicitudProceso);
	
	let datos = new FormData();
	datos.append("solicitudProceso", solicitudProceso);

	$.ajax({
		url:"ajax/vehiculos-solicitudes.ajax.php",
		method:"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){

			$("#loading-max").fadeIn('slow');
		}, 	
		success:function(respuesta){

			console.log("respuesta", respuesta);

			if(respuesta == "ok"){

				Swal.fire({
					position: "top-end",
					icon: "success",
					title: "Se ha procesado",
					allowOutsideClick: false,
					showConfirmButton: true
					// timer: 1500
				}).then((result)=> {

					if(result.value){

						window.location = "solicitudes-vehiculo";
					}

				}); 

			}

			$("#loading-max").fadeOut('slow');

		}

	});

});




$(".tablaVehiculos tbody").on("click", ".btnAgregarFoto", function(){

	const idVehiculo = $(this).attr("idVehiculo");
	// console.log("idVehiculo", idVehiculo);
	$(".previsualizarVehiculo").val("");
	$(".previsualizarVehiculo").html("");

	let datos = new FormData();
	datos.append("idVehiculo", idVehiculo);

	$.ajax({
		url:"ajax/vehiculos.ajax.php",
		method:"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){

			$("#loading-max").fadeIn('slow');
		}, 	
		success:function(respuesta){
			$("#loading-max").fadeOut('slow');
			// console.log("respuesta", respuesta);
			$("#editarFotoId").val(respuesta["idVehiculo"]);
			$("#folioVehiculoId").val(respuesta["folio"]);
			$("#numEcoId").val(respuesta["eco"]);
			$("#fotoActualVehiculo").val(respuesta["imagen"]);

		}

	});






});




$(".tablaSolicitudesVehiculos tbody").on("click", ".btnFinalizarSolicitud", function(){

	const solicitudFinalizar = $(this).attr("idSolicitud");
	// console.log("solicitudFinalizar", solicitudFinalizar);
	
	let datos = new FormData();
	datos.append("solicitudFinalizar", solicitudFinalizar);

	$.ajax({
		url:"ajax/vehiculos-solicitudes.ajax.php",
		method:"POST",
		data:datos,
		cache: false,
		contentType: false,
		processData: false,
		dataType: "json",
		beforeSend:function(o){

			$("#loading-max").fadeIn('slow');
		}, 	
		success:function(respuesta){

			console.log("respuesta", respuesta);

			if(respuesta == "ok"){

				Swal.fire({
					position: "top-end",
					icon: "success",
					title: "Se ha finalizado",
					allowOutsideClick: false,
					showConfirmButton: true
					// timer: 1500
				}).then((result)=> {

					if(result.value){

						window.location = "solicitudes-vehiculo";
					}

				}); 

			}

			$("#loading-max").fadeOut('slow');

		}

	});

});




$(document).ready(function(){ 

$("#tablaVehiculos2").DataTable({

   "ajax": 'ajax/dataTableVehiculos.php',
   "processing": true, 
   "serverSide": true,
   "pageLength": 15,

    "lengthMenu": [ 15, 25, 50, 75, 100 ],

	"language": {

		"sProcessing":     "<div class='loader'></div>",
		"sLengthMenu":     "Mostrar _MENU_ registros",
		"sZeroRecords":    "No se encontraron resultados",
		"sEmptyTable":     "Ningún dato disponible en esta tabla",
		"sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_",
		"sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0",
		"sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
		"sInfoPostFix":    "",
		"sSearch":         "Buscar Registros:",
    	"searchPlaceholder": "Ingresa el registro a buscar",
		"sUrl":            "",
		"sInfoThousands":  ",",
		"sLoadingRecords": "Cargando...",
		"oPaginate": {
		"sFirst":    "Primero",
		"sLast":     "Último",
		"sNext":     "Siguiente",
		"sPrevious": "Anterior"

		},

		"oAria": {
			"sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
			"sSortDescending": ": Activar para ordenar la columna de manera descendente"
		}

	}, 

   "responsive": true, "lengthChange": true, "autoWidth": false,

})

})






/*--==========================================================
    ==========================================================
    ==========================================================
    ==========================================================

            MODULO DE PROCESAMIENTO EN ALTA DE PDF 

   ===========================================================
   ===========================================================
   ===========================================================   
==============================================================--*/

$(".nuevoFileSolicitud").change(function(){  

	let file = this.files[0];
	// console.log("file", file);

	if(file["type"] != "image/jpeg" && file["type"] != "image/png" && file["type"] != "application/pdf"){

		$(".nuevoFileSolicitud").val("");

		Swal.fire({
			title:"Error al subir el documento",
			text:"El archivo debe estar en formato JPG | PNG | PDF",
			icon:"error",
			confirmButtonText: "¡ Cerrar !"
		});

	}else if(file["size"] > 2000000){

		$(".nuevoFileSolicitud").val("");

		Swal.fire({
			title:"Error al subir el documento",
			text:"El archivo no debe superar los 2 MB",
			icon:"error",
			confirmButtonText: "¡ Cerrar !"
		});

	}

});





$(".editarFotoVehiculo").change(function(){   

	let file = this.files[0];
	// console.log("file", file);

	if(file["type"] != "image/jpeg" && file["type"] != "image/png"){

		$(".editarFotoVehiculo").val("");

		Swal.fire({
			title:"Error al subir el documento",
			text:"El archivo debe estar en formato JPG | PNG ",
			icon:"error",
			confirmButtonText: "¡ Cerrar !"
		});

	}else if(file["size"] > 2000000){

		$(".editarFotoVehiculo").val("");

		Swal.fire({
			title:"Error al subir el documento",
			text:"El archivo no debe superar los 2 MB",
			icon:"error",
			confirmButtonText: "¡ Cerrar !"
		});

	}else{

		let datosImagen = new FileReader;
		datosImagen.readAsDataURL(file);

		$(datosImagen).on("load",function(event){
			let rutaImagen = event.target.result;
			$(".previsualizarVehiculo").attr("src", rutaImagen);
		})
	}

});


